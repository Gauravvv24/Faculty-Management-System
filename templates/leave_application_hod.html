{% extends "sidebar_hod.html" %}

{% block body %}
<style>
    :root {
--font-family-sans-serif: "Open Sans", -apple-system, BlinkMacSystemFont,
"Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji",
"Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
}

*, *::before, *::after {
-webkit-box-sizing: border-box;
box-sizing: border-box;
}

html {
font-family: sans-serif;
line-height: 1.15;
-webkit-text-size-adjust: 100%;
-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

nav {
display: block;
}

body {
margin: 0;
font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI",
Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji",
"Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
font-size: 1rem;
font-weight: 400;
line-height: 1.5;
color: #000000;
text-align: left;
background-color: #ffffff;
}

.container {
margin-left: 0px;
width: 1200px;
}

h1, h2, h3, h4, h5, h6 {
margin-top: 0;
margin-bottom: 0.5rem;
}

p {
margin-top: 0;
margin-bottom: 1rem;
}

a {
color: #ffffcc;
text-decoration: none;
background-color: transparent;
}

a:hover {
color: #ffffcc;
text-decoration: underline;
}

h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
font-family: "Nunito", sans-serif;
margin-bottom: 0.5rem;
font-weight: 500;
line-height: 1.2;
}

h1, .h1 {
font-size: 2.5rem;
font-weight: normal;
}

.dashboard {
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
min-height: 100vh;
}

.dashboard-app {
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-orient: vertical;
-webkit-box-direction: normal;
-webkit-flex-direction: column;
-ms-flex-direction: column;
flex-direction: column;
-webkit-box-flex: 2;
-webkit-flex-grow: 2;
-ms-flex-positive: 2;
flex-grow: 2;
margin-top: 84px;
}

.dashboard-content {
-webkit-box-flex: 2;
-webkit-flex-grow: 2;
-ms-flex-positive: 2;
flex-grow: 2;
padding: 25px;
}

.dashboard-nav {
min-width: 238px;
position: fixed;
left: 0;
top: 0;
bottom: 0;
overflow: auto;
background-color: #fd8d15;
}

.dashboard-compact .dashboard-nav {
display: none;
}

.dashboard-nav header {
min-height: 84px;
padding: 8px 27px;
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-pack: center;
-webkit-justify-content: center;
-ms-flex-pack: center;
justify-content: center;
-webkit-box-align: center;
-webkit-align-items: center;
-ms-flex-align: center;
align-items: center;
}

.dashboard-nav header .menu-toggle {
display: none;
margin-right: auto;
}

.dashboard-nav a {
color: #b32525;
}

.dashboard-nav a:hover {
text-decoration: none;
}

.dashboard-nav {
background-color: #fd8d15;
}

.dashboard-nav a {
color: black;
}

.dashboard-nav-list {
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-orient: vertical;
-webkit-box-direction: normal;
-webkit-flex-direction: column;
-ms-flex-direction: column;
flex-direction: column;
}

.dashboard-nav-item {
min-height: 56px;
padding: 8px 20px 8px 70px;
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-align: center;
-webkit-align-items: center;
-ms-flex-align: center;
align-items: center;
letter-spacing: 0.02em;
transition: ease-out 0.5s;
}

.dashboard-nav-item i {
width: 36px;
font-size: 19px;
margin-left: -40px;
}

.dashboard-nav-item:hover {
background: #ffffcc;
}


.menu-toggle {
position: relative;
width: 42px;
height: 42px;
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-align: center;
-webkit-align-items: center;
-ms-flex-align: center;
align-items: center;
-webkit-box-pack: center;
-webkit-justify-content: center;
-ms-flex-pack: center;
justify-content: center;
color: #fd8d15;
}

.menu-toggle:hover, .menu-toggle:active, .menu-toggle:focus {
text-decoration: none;
color: #fd8d15;
}

.menu-toggle i {
font-size: 20px;
}

.dashboard-toolbar {
min-height: 84px;
background-color: #ffffff;
display: -webkit-box;
display: -webkit-flex;
display: -ms-flexbox;
display: flex;
-webkit-box-align: center;
-webkit-align-items: center;
-ms-flex-align: center;
align-items: center;
padding: 8px 27px;
position: fixed;
top: 0;
right: 0;
left: 0;
z-index: 1000;
}

.nav-item-divider {
height: 1px;
margin: 1rem 0;
overflow: hidden;
background-color: white;
}

@media (min-width: 992px) {
.dashboard-app {
    margin-left: 238px;
}

.dashboard-compact .dashboard-app {
    margin-left: 0;
}
}

@media (min-width: 1200px) {
.container {
    max-width: 1200px;
}
}

@media (max-width: 768px) {
.dashboard-content {
    padding: 15px 0px;
}
}

@media (max-width: 992px) {
.dashboard-nav {
    display: none;
    position: fixed;
    top: 0;
    right: 0;
    left: 0;
    bottom: 0;
    z-index: 1070;
}

.dashboard-nav.mobile-show {
    display: block;
}
}

@media (max-width: 992px) {
.dashboard-nav header .menu-toggle {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
}
}

@media (min-width: 992px) {
.dashboard-toolbar {
    left: 238px;
}

.dashboard-compact .dashboard-toolbar {
    left: 0;
}
}

.badge {
font-size: 100%;
padding: 0.4em 0.4em;
border-radius: 0.25rem;
}

.bg-success {
background-color: #2a7e49;
color: #ffffff;
}

.bg-warning {
background-color: #fad817!important;
color: #000000;
}

.bg-danger {
background-color: #ff3232;
color: #ffffff;
}

.bg-unavailable {
background-color: #181717;
color: #ffffff;
}
.container {
    margin-left: 10px;
}

.dashboard-app {
    margin-left: 0;
}

.dashboard-content {
    padding: 1px;
}

/* Update the form layout to align elements to the left */
.form-group {
    text-align: left;
}

</style>
<form action='leave_application_hod' method='GET'>
    {% csrf_token %}
    <div class='dashboard-app'>
        <div class='dashboard-content'>
            <div class='container'>
                <div class="title">
                    <h1>Leave Application</h1>
                    <h4></h4>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th class="text-center">Name</th>
                                        <th class="text-center">Description</th>
                                        <th class="text-center">Start-Date</th>
                                        <th class="text-center">End-Date</th>
                                        <th class="text-center">Status</th>
                                        <th class="text-center">Action</th>  <!-- New column for Delete button -->
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in main %}
                                    {% if item is not None%}
                                    <tr>
                                        <td class="text-center">{{ item.0 }} {{item.1}}</td>
                                        <td class="text-center">{{ item.3 }}</td>
                                        <td class="text-center">{{ item.4 }}</td>
                                        <td class="text-center">{{ item.5 }}</td>
                                        {% if item.6 == 'Approved' %}
                                            <td class="text-center"><span class="badge bg-success">Approved</span></td>
                                        {% elif item.6 == 'Pending' %}
                                            <td class="text-center"><span class="badge bg-warning">Pending</span></td>
                                        {% elif item.6 == 'Rejected' %}
                                            <td class="text-center"><span class="badge bg-danger">Rejected</span></td>
                                        {% elif item.6 == 'Unavailable' %}
                                            <td class="text-center"><span class="badge bg-unavailable">Unavailable</span></td>
                                        {% endif %}
                                        {% csrf_token %}
                                        <td class="text-center">
                                            <button type="button" class="btn badge bg-success status-btn" data-first="{{ item.0 }}" data-last="{{ item.1 }}" data-description="{{ item.3 }}" data-start-date="{{ item.4 }}" data-end-date="{{ item.5 }}" data-status="Approved">Approve</button>
                                            <button type="button" class="btn badge bg-danger status-btn" data-first="{{ item.0 }}" data-last="{{ item.1 }}" data-description="{{ item.3 }}" data-start-date="{{ item.4 }}" data-end-date="{{ item.5 }}"  data-status="Rejected">Reject</button></td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- JavaScript for handling Delete button click event -->
<script>
    document.querySelectorAll('.status-btn').forEach(button => {
        button.addEventListener('click', () => {
            const first_name = button.getAttribute('data-first');
            const last_name = button.getAttribute('data-last');
            const description = button.getAttribute('data-description');
            const startDate = button.getAttribute('data-start-date');
            const endDate = button.getAttribute('data-end-date');
            const status = button.getAttribute('data-status');
            


            // Do something with the extracted data (e.g., send it to a server via AJAX)
            $.ajax({
                action : 'leave_application_hod',
                method: 'POST',
                headers: {
                    'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()
                },
                data: {
                    'first_name' : first_name,
                    'last_name' : last_name,
                    'description': description,
                    'start_date': startDate,
                    'end_date': endDate,
                    'status': status,
                    
                },
                success: function(response) {
                    displayMessage('Changes Done', 'green');
                },
                error: function(error) {
                    displayMessage('Error', 'red');
                }
            });
        
            return false; // Prevent the form from submitting normally
        });
    });

    function displayMessage(message, color) {
        const messageBox = document.createElement('div');
        messageBox.textContent = message;
        messageBox.style.backgroundColor = color;
        messageBox.style.padding = '10px';
        messageBox.style.color = 'white';
        messageBox.style.marginTop = '10px';
        messageBox.style.transition = 'opacity 5s'; 
        messageBox.style.marginLeft = '249px';
        document.body.appendChild(messageBox);

        messageBox.getBoundingClientRect();

        messageBox.style.opacity = 1;

        setTimeout(function() {
            messageBox.style.opacity = 0;
        }, 5000);
    }
</script>

{% endblock body %}
